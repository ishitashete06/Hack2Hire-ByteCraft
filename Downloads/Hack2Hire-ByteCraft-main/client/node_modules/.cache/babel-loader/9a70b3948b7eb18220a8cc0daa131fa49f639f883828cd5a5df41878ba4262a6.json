{"ast":null,"code":"// We disable the rule of hooks because we early return when not in the preview\n// or on a touch device. This early return will be constistent per environment.\n/* eslint-disable react-hooks/rules-of-hooks */\nimport React, { useEffect } from \"react\";\nimport { Point } from \"../../render/types/Point.js\";\nimport { RenderTarget } from \"../../render/types/RenderEnvironment.js\";\nimport { isSafari, isTouch } from \"../../utils/environment.js\";\nimport { safeWindow } from \"../../utils/safeWindow.js\";\nimport { animatePointWithInertia } from \"./animatePointWithInertia.js\";\nconst scrollThreshold = 3;\nconst isTouchDevice = /* @__PURE__ */isTouch();\nconst isSafariBrowser = /* @__PURE__ */isSafari();\nfunction getTouchAction(element) {\n  if (!(element instanceof HTMLElement)) return null;\n  return element.style.touchAction;\n}\nfunction canPanInDirection(element, direction) {\n  switch (direction) {\n    case \"horizontal\":\n      return getTouchAction(element) === \"pan-x\";\n    case \"vertical\":\n      return getTouchAction(element) === \"pan-y\";\n    default:\n      return false;\n  }\n}\nfunction isInteractiveElement(element) {\n  const tag = element.tagName.toLowerCase();\n  if (tag === \"input\") return true;\n  if (tag === \"text\") return true;\n  if (tag === \"textarea\") return true;\n  return false;\n}\nfunction canStartScrollFromElement(element, direction) {\n  if (!(element instanceof Element)) return false;\n  if (isInteractiveElement(element)) return false;\n  if (element.hasAttribute(\"draggable\")) {\n    if (!canPanInDirection(element, direction)) {\n      return false;\n    }\n  }\n  return true;\n}\nfunction getEventPoint(event) {\n  return {\n    x: event.pageX,\n    y: event.pageY\n  };\n}\nfunction setStyle(element, property, value) {\n  if (element?.style) {\n    element.style[property] = value;\n  }\n}\nfunction getStyle(element, property) {\n  return element?.style?.[property];\n}\nvar TouchScrollPhase;\n(function (TouchScrollPhase) {\n  TouchScrollPhase[TouchScrollPhase[\"Idle\"] = 0] = \"Idle\";\n  TouchScrollPhase[TouchScrollPhase[\"TouchDown\"] = 1] = \"TouchDown\";\n  TouchScrollPhase[TouchScrollPhase[\"Drag\"] = 2] = \"Drag\";\n  TouchScrollPhase[TouchScrollPhase[\"DragLocked\"] = 3] = \"DragLocked\";\n  TouchScrollPhase[TouchScrollPhase[\"DragAnimation\"] = 4] = \"DragAnimation\";\n  TouchScrollPhase[TouchScrollPhase[\"Interrupted\"] = 5] = \"Interrupted\";\n})(TouchScrollPhase || (TouchScrollPhase = {}));\nconst emptyObject = {};\nObject.freeze(emptyObject);\nexport function useEmulateTouchScroll(ref, direction, enabled) {\n  if (isTouchDevice) return emptyObject;\n  if (RenderTarget.current() !== RenderTarget.preview) return emptyObject;\n  const scrollAnimationControlsRef = React.useRef(null);\n  useEffect(() => {\n    if (!ref.current) return;\n    const element = ref.current;\n    let phase = TouchScrollPhase.Idle;\n    let targets = null;\n    let downPoint = null;\n    let scrollOffsetStart = null;\n    let mouseMoveEvents = [];\n    function onMouseMove(event) {\n      switch (phase) {\n        case TouchScrollPhase.Idle:\n        case TouchScrollPhase.DragAnimation:\n        case TouchScrollPhase.DragLocked:\n          return;\n      }\n      // If command is pressed we fallback to normal behavior\n      if (event.metaKey) return;\n      const point = getEventPoint(event);\n      if (!downPoint) return;\n      // Calculate the offset so we can use it in the callback\n      const offset = Point.subtract(point, downPoint);\n      // If we didn't scroll before and reached the threshold\n      if (phase === TouchScrollPhase.TouchDown || phase === TouchScrollPhase.Interrupted) {\n        const deltaX = Math.abs(offset.x);\n        const deltaY = Math.abs(offset.y);\n        if ((deltaX > scrollThreshold || deltaY > scrollThreshold) && deltaX !== deltaY) {\n          const scrollDirection = deltaX > deltaY ? \"horizontal\" : \"vertical\";\n          const shouldIgnoreBecauseOfDirectionLock = direction === \"horizontal\" && scrollDirection === \"vertical\" || direction === \"vertical\" && scrollDirection === \"horizontal\";\n          if (shouldIgnoreBecauseOfDirectionLock) {\n            phase = TouchScrollPhase.DragLocked;\n            return;\n          }\n          phase = TouchScrollPhase.Drag;\n          // We disable events on the clicked target so we avoid clicks if you mean to scroll\n          targets?.forEach(([target]) => setStyle(target, \"pointerEvents\", \"none\"));\n        }\n      }\n      // We need this in Safari to avoid scroll from text selection near borders\n      // Unfortunately we'll have to do this for all events and this could break\n      // in subtle ways.\n      if (isSafariBrowser) event.preventDefault();\n      // Don't do anything if we didn't reach the threshold\n      if (phase !== TouchScrollPhase.Drag) return;\n      // Don't start selecting text too\n      safeWindow.getSelection()?.empty();\n      mouseMoveEvents = getRecentEvents([...mouseMoveEvents, event]);\n      // Update offset\n      if (scrollOffsetStart) {\n        if (direction !== \"vertical\") element.scrollLeft = scrollOffsetStart.x - offset.x;\n        if (direction !== \"horizontal\") element.scrollTop = scrollOffsetStart.y - offset.y;\n      }\n    }\n    function onMouseUp(event) {\n      safeWindow.removeEventListener(\"mousemove\", onMouseMove, false);\n      safeWindow.removeEventListener(\"mouseup\", onMouseUp);\n      // Make sure to restore events back on the element if we removed them\n      if (phase === TouchScrollPhase.Drag && targets) {\n        targets.forEach(([target, originalPointerEventsValue]) => setStyle(target, \"pointerEvents\", originalPointerEventsValue || \"auto\"));\n      }\n      targets = null;\n      const velocity = calculateVelocity({\n        mouseMoveEvents,\n        mouseUpEvent: event\n      });\n      downPoint = null;\n      if (phase === TouchScrollPhase.Drag) {\n        // Scroll\n        // Unlike page snapping we only have to animate the scroll if we started a drag\n        const shouldAnimateY = direction !== \"horizontal\" && velocity.y !== 0;\n        const shouldAnimateX = direction !== \"vertical\" && velocity.x !== 0;\n        if (!shouldAnimateY && !shouldAnimateX) {\n          phase = TouchScrollPhase.Idle;\n          return;\n        }\n        phase = TouchScrollPhase.DragAnimation;\n        scrollAnimationControlsRef.current = animatePointWithInertia({\n          from: {\n            x: element.scrollLeft,\n            y: element.scrollTop\n          },\n          velocity: {\n            x: shouldAnimateX ? velocity.x : 0,\n            y: shouldAnimateY ? velocity.y : 0\n          },\n          onUpdate: position => {\n            if (shouldAnimateX) element.scrollLeft = position.x;\n            if (shouldAnimateY) element.scrollTop = position.y;\n          },\n          onStop: () => {\n            if (phase !== TouchScrollPhase.Interrupted) {\n              phase = TouchScrollPhase.Idle;\n            }\n            scrollAnimationControlsRef.current = null;\n          },\n          onComplete: () => {\n            if (phase !== TouchScrollPhase.DragAnimation) {\n              throw Error(\"On animation completion we should still be in the animation phase\");\n            }\n            phase = TouchScrollPhase.Idle;\n            scrollAnimationControlsRef.current = null;\n          }\n        });\n      } else {\n        phase = TouchScrollPhase.Idle;\n      }\n    }\n    function onMouseWheel() {\n      // Stop any running animations when using mouse wheel or trackpad\n      scrollAnimationControlsRef.current?.stop();\n    }\n    function onMouseDown(event) {\n      if (!enabled) return;\n      // If command or control was entered we fallback to normal behavior\n      if (event.metaKey) return;\n      if (!canStartScrollFromElement(event.target, direction)) {\n        // Stop any running scroll animation\n        if (phase === TouchScrollPhase.DragAnimation) {\n          phase = TouchScrollPhase.Idle;\n          scrollAnimationControlsRef.current?.stop();\n        }\n        return;\n      }\n      const previousPhase = phase;\n      phase = previousPhase === TouchScrollPhase.DragAnimation ? TouchScrollPhase.Interrupted : TouchScrollPhase.TouchDown;\n      downPoint = getEventPoint(event);\n      targets = document.elementsFromPoint(downPoint.x, downPoint.y).filter(targetEl => targetEl instanceof HTMLElement || targetEl instanceof SVGElement).map(targetEl => [targetEl, getStyle(targetEl, \"pointerEvents\")]);\n      scrollOffsetStart = {\n        x: element.scrollLeft,\n        y: element.scrollTop\n      };\n      mouseMoveEvents = [];\n      if (scrollAnimationControlsRef.current) {\n        if (previousPhase !== TouchScrollPhase.DragAnimation) {\n          throw Error(\"When stopping a drag animation we need to be animating\");\n        }\n        scrollAnimationControlsRef.current.stop();\n      }\n      safeWindow.addEventListener(\"mousemove\", onMouseMove);\n      safeWindow.addEventListener(\"mouseup\", onMouseUp);\n      element.addEventListener(\"mousewheel\", onMouseWheel);\n    }\n    // Set up a the base handler on the scrollable element\n    element.addEventListener(\"mousedown\", onMouseDown);\n    return () => {\n      // Clean up all event handlers on unmount\n      element.removeEventListener(\"mousedown\", onMouseDown);\n      element.removeEventListener(\"mousewheel\", onMouseWheel);\n      safeWindow.removeEventListener(\"mousemove\", onMouseMove);\n      safeWindow.removeEventListener(\"mouseup\", onMouseUp);\n      // Stop any running scroll animations\n      phase = TouchScrollPhase.Interrupted;\n      scrollAnimationControlsRef.current?.stop();\n    };\n  }, [ref, direction, enabled]);\n  return React.useMemo(() => {\n    return {\n      cancelEmulatedTouchScrollAnimation: () => {\n        scrollAnimationControlsRef.current?.stop();\n      }\n    };\n  }, []);\n}\n// Keep events that are younger than 4 / 60 s\nconst timeDelta = 4 / 60 * 1000;\nfunction getRecentEvents(events) {\n  // There is no API to get the time origin of event timestamps, as a workaround\n  // we create a custom event and read the timestamp\n  const currentTime = new CustomEvent(\"getTime\").timeStamp;\n  const maxAge = currentTime - timeDelta;\n  return events.filter(event => event.timeStamp > maxAge);\n}\nconst zeroPoint = {\n  x: 0,\n  y: 0\n};\nexport function calculateVelocity({\n  mouseMoveEvents,\n  mouseUpEvent\n}) {\n  const recentMouseMoveEvents = getRecentEvents(mouseMoveEvents);\n  const oldestMouseMoveEvent = recentMouseMoveEvents[0];\n  if (!oldestMouseMoveEvent) return zeroPoint;\n  const deltaX = mouseUpEvent.clientX - oldestMouseMoveEvent.clientX;\n  const deltaY = mouseUpEvent.clientY - oldestMouseMoveEvent.clientY;\n  const time = mouseUpEvent.timeStamp - oldestMouseMoveEvent.timeStamp;\n  if (time === 0) return zeroPoint;\n  return {\n    x: deltaX / time * 1000,\n    y: deltaY / time * 1000\n  };\n}","map":{"version":3,"names":["React","useEffect","Point","RenderTarget","isSafari","isTouch","safeWindow","animatePointWithInertia","scrollThreshold","isTouchDevice","isSafariBrowser","getTouchAction","element","HTMLElement","style","touchAction","canPanInDirection","direction","isInteractiveElement","tag","tagName","toLowerCase","canStartScrollFromElement","Element","hasAttribute","getEventPoint","event","x","pageX","y","pageY","setStyle","property","value","getStyle","TouchScrollPhase","emptyObject","Object","freeze","useEmulateTouchScroll","ref","enabled","current","preview","scrollAnimationControlsRef","useRef","phase","Idle","targets","downPoint","scrollOffsetStart","mouseMoveEvents","onMouseMove","DragAnimation","DragLocked","metaKey","point","offset","subtract","TouchDown","Interrupted","deltaX","Math","abs","deltaY","scrollDirection","shouldIgnoreBecauseOfDirectionLock","Drag","forEach","target","preventDefault","getSelection","empty","getRecentEvents","scrollLeft","scrollTop","onMouseUp","removeEventListener","originalPointerEventsValue","velocity","calculateVelocity","mouseUpEvent","shouldAnimateY","shouldAnimateX","from","onUpdate","position","onStop","onComplete","Error","onMouseWheel","stop","onMouseDown","previousPhase","document","elementsFromPoint","filter","targetEl","SVGElement","map","addEventListener","useMemo","cancelEmulatedTouchScrollAnimation","timeDelta","events","currentTime","CustomEvent","timeStamp","maxAge","zeroPoint","recentMouseMoveEvents","oldestMouseMoveEvent","clientX","clientY","time"],"sources":["../../../src/components/utils/useEmulatedTouchScroll.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}