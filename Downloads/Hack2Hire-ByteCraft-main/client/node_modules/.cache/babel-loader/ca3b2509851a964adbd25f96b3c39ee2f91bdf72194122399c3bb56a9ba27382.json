{"ast":null,"code":"import { useEffect, useRef } from \"react\";\n/**\n * Workarounds for WebKit bugs\n * Some styles have to be toggled to take effect in certain situations.\n * To use in a class, see Layer.tsx\n * @internal\n */\nexport function useWebkitFixes(elementRef, style) {\n  const mixBlendModeSet = style.mixBlendMode && style.mixBlendMode !== \"normal\";\n  const radiusSet = style.borderRadius !== undefined;\n  const clip = style.overflow === \"hidden\";\n  useDidUpdate(() => {\n    if (mixBlendModeSet) {\n      resetSetStyle(elementRef.current, \"mixBlendMode\", style.mixBlendMode);\n    }\n    // Note: this used to be dependent on re-rendering after any zoom change. If this causes regressions we can find a solution to restore or replace that behavior.\n  }, [mixBlendModeSet, elementRef.current]);\n  useDidUpdate(() => {\n    if (clip && radiusSet) {\n      resetSetStyle(elementRef.current, \"overflow\", \"hidden\", false);\n    }\n  }, [clip, radiusSet, elementRef.current]);\n}\nfunction useDidUpdate(update, dependencies) {\n  // Because hasMounted only changes and is only used inside of useEffect, it's not a dependency\n  const hasMounted = useRef(false);\n  useEffect(() => {\n    if (hasMounted.current) {\n      update();\n    }\n    hasMounted.current = true;\n  }, dependencies);\n}\n/** @internal */\nexport function resetSetStyle(element, key, toValue, microtask = true) {\n  if (!element) {\n    return;\n  }\n  const value = toValue ? toValue : element.style[key];\n  const reset = () => {\n    element.style[key] = value;\n  };\n  element.style[key] = null;\n  if (microtask) {\n    void Promise.resolve().then(reset);\n  } else {\n    setTimeout(reset, 0);\n  }\n}","map":{"version":3,"names":["useEffect","useRef","useWebkitFixes","elementRef","style","mixBlendModeSet","mixBlendMode","radiusSet","borderRadius","undefined","clip","overflow","useDidUpdate","resetSetStyle","current","update","dependencies","hasMounted","element","key","toValue","microtask","value","reset","Promise","resolve","then","setTimeout"],"sources":["../../../src/render/utils/useWebkitFixes.ts"],"sourcesContent":[null],"mappings":"AAGA,SAASA,SAAS,EAAEC,MAAM,QAAQ,OAAO;AAEzC;;;;;;AAMA,OAAM,SAAUC,cAAcA,CAACC,UAAkC,EAAEC,KAAkB;EACjF,MAAMC,eAAe,GAAGD,KAAK,CAACE,YAAY,IAAIF,KAAK,CAACE,YAAY,KAAK,QAAQ;EAC7E,MAAMC,SAAS,GAAGH,KAAK,CAACI,YAAY,KAAKC,SAAS;EAClD,MAAMC,IAAI,GAAGN,KAAK,CAACO,QAAQ,KAAK,QAAQ;EACxCC,YAAY,CAAC,MAAK;IACd,IAAIP,eAAe,EAAE;MACjBQ,aAAa,CAACV,UAAU,CAACW,OAAO,EAAE,cAAc,EAAEV,KAAK,CAACE,YAAY,CAAC;;IAEzE;EACJ,CAAC,EAAE,CAACD,eAAe,EAAEF,UAAU,CAACW,OAAO,CAAC,CAAC;EACzCF,YAAY,CAAC,MAAK;IACd,IAAIF,IAAI,IAAIH,SAAS,EAAE;MACnBM,aAAa,CAACV,UAAU,CAACW,OAAO,EAAE,UAAU,EAAE,QAAQ,EAAE,KAAK,CAAC;;EAEtE,CAAC,EAAE,CAACJ,IAAI,EAAEH,SAAS,EAAEJ,UAAU,CAACW,OAAO,CAAC,CAAC;AAC7C;AAEA,SAASF,YAAYA,CAACG,MAAkB,EAAEC,YAAmB;EACzD;EACA,MAAMC,UAAU,GAAGhB,MAAM,CAAC,KAAK,CAAC;EAChCD,SAAS,CAAC,MAAK;IACX,IAAIiB,UAAU,CAACH,OAAO,EAAE;MACpBC,MAAM,EAAE;;IAEZE,UAAU,CAACH,OAAO,GAAG,IAAI;EAC7B,CAAC,EAAEE,YAAY,CAAC;AACpB;AAEA;AACA,OAAM,SAAUH,aAAaA,CACzBK,OAAwC,EACxCC,GAAW,EACXC,OAAmB,EACnBC,SAAA,GAAqB,IAAI;EAEzB,IAAI,CAACH,OAAO,EAAE;IACV;;EAGJ,MAAMI,KAAK,GAAGF,OAAO,GAAGA,OAAO,GAAGF,OAAO,CAACd,KAAK,CAACe,GAAG,CAAC;EACpD,MAAMI,KAAK,GAAGA,CAAA,KAAK;IACfL,OAAO,CAACd,KAAK,CAACe,GAAG,CAAC,GAAGG,KAAK;EAC9B,CAAC;EACDJ,OAAO,CAACd,KAAK,CAACe,GAAG,CAAC,GAAG,IAAI;EACzB,IAAIE,SAAS,EAAE;IACX,KAAKG,OAAO,CAACC,OAAO,EAAE,CAACC,IAAI,CAACH,KAAK,CAAC;GACrC,MAAM;IACHI,UAAU,CAACJ,KAAK,EAAE,CAAC,CAAC;;AAE5B","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}