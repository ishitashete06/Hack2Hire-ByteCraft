{"ast":null,"code":"import React from \"react\";\nimport { StyleSheetContext } from \"../render/StyleSheetContext.js\";\nimport * as CSS from \"../render/utils/setDocumentStyles.js\";\nimport { isBrowser } from \"../utils/environment.js\";\nif (isBrowser()) {\n  // FIXME: this is mostly unnecessary as of https://github.com/framer/FramerStudio/pull/10631\n  // because the minification process during SSG will move all the CSS into the <head>.\n  // It still matters for a rare occassion when a site failed to be optimized (eg due to SSG errors).\n  // Move the SSR-injected <style> tags to <head> to avoid React hydration errors.\n  for (const node of document.querySelectorAll(\"style[data-framer-css-ssr]\")) {\n    document.head.appendChild(node);\n  }\n}\n// Figure out which elements had their styles server-rendered – and avoid injecting their styles again.\n// We’re doing this for a) performance, b) DX (this reduces the number of duplicated styles in DevTools).\n// (Using /* #__PURE__ */ to make sure this gets removed from the bundle when `withCSS` is tree-shaken away: https://paper.dropbox.com/doc/Preventing-side-effects-in-library-modules-tree-shaking--BxcI9HHYeVPCEpLgMyyfm40nAg-0nsRQl6w28wgW6KTTX7Tm.)\nconst componentsWithServerRenderedStyles = /* #__PURE__ */(() => {\n  if (!isBrowser()) return new Set();\n  const componentsWithSSRStylesAttr = document.querySelector(\"style[data-framer-css-ssr-minified]\")?.getAttribute(\"data-framer-components\");\n  if (!componentsWithSSRStylesAttr) return new Set();\n  return new Set(componentsWithSSRStylesAttr.split(\" \"));\n})();\nexport const styleTagSSRMarker = {\n  \"data-framer-css-ssr\": true\n};\n/**\n * Render a React component with css that will be injected into the document's\n * head when the component is first rendered. The escapedCSS argument can either\n * be a string where each line is a css rule, or an array of css rule strings.\n *\n * @public\n */\nexport const withCSS = (Component, escapedCSS,\n// This might be `undefined` in older components that got published before https://github.com/framer/FramerStudio/pull/13459\ncomponentSerializationId) => React.forwardRef((props, ref) => {\n  const {\n    sheet,\n    cache\n  } = React.useContext(StyleSheetContext) ?? {};\n  if (!isBrowser()) {\n    const concatenatedCSS = Array.isArray(escapedCSS) ? escapedCSS.join(\"\\n\") : escapedCSS;\n    return React.createElement(React.Fragment, null, React.createElement(\"style\", {\n      ...styleTagSSRMarker,\n      \"data-framer-component\": componentSerializationId,\n      dangerouslySetInnerHTML: {\n        __html: concatenatedCSS\n      }\n    }), React.createElement(Component, {\n      ...props,\n      ref: ref\n    }));\n  }\n  // eslint-disable-next-line react-hooks/rules-of-hooks\n  React.useInsertionEffect(() => {\n    // If the styles already exist in the head due to SSG, avoid\n    // re-adding them to improve hydration performance.\n    if (componentSerializationId && componentsWithServerRenderedStyles.has(componentSerializationId)) return;\n    const css = Array.isArray(escapedCSS) ? escapedCSS : escapedCSS.split(\"\\n\");\n    css.forEach(rule => rule && CSS.injectCSSRule(rule, sheet, cache));\n  }, []);\n  return React.createElement(Component, {\n    ...props,\n    ref: ref\n  });\n});","map":{"version":3,"names":["React","StyleSheetContext","CSS","isBrowser","node","document","querySelectorAll","head","appendChild","componentsWithServerRenderedStyles","Set","componentsWithSSRStylesAttr","querySelector","getAttribute","split","styleTagSSRMarker","withCSS","Component","escapedCSS","componentSerializationId","forwardRef","props","ref","sheet","cache","useContext","concatenatedCSS","Array","isArray","join","createElement","Fragment","dangerouslySetInnerHTML","__html","useInsertionEffect","has","css","forEach","rule","injectCSSRule"],"sources":["../../src/modules/withCSS.tsx"],"sourcesContent":[null],"mappings":"AAAA,OAAOA,KAAK,MAAM,OAAO;AAEzB,SAASC,iBAAiB,QAAgC,gCAAgC;AAC1F,OAAO,KAAKC,GAAG,MAAM,sCAAsC;AAC3D,SAASC,SAAS,QAAQ,yBAAyB;AAEnD,IAAIA,SAAS,EAAE,EAAE;EACb;EACA;EACA;EACA;EACA,KAAK,MAAMC,IAAI,IAAIC,QAAQ,CAACC,gBAAgB,CAAC,4BAA4B,CAAC,EAAE;IACxED,QAAQ,CAACE,IAAI,CAACC,WAAW,CAACJ,IAAI,CAAC;;;AAIvC;AACA;AACA;AACA,MAAMK,kCAAkC,GAAgB,eAAgB,CAAC,MAAK;EAC1E,IAAI,CAACN,SAAS,EAAE,EAAE,OAAO,IAAIO,GAAG,EAAE;EAElC,MAAMC,2BAA2B,GAAGN,QAAQ,CACvCO,aAAa,CAAC,qCAAqC,CAAC,EACnDC,YAAY,CAAC,wBAAwB,CAAC;EAE5C,IAAI,CAACF,2BAA2B,EAAE,OAAO,IAAID,GAAG,EAAE;EAElD,OAAO,IAAIA,GAAG,CAACC,2BAA2B,CAACG,KAAK,CAAC,GAAG,CAAC,CAAC;AAC1D,CAAC,EAAC,CAAE;AAEJ,OAAO,MAAMC,iBAAiB,GAAG;EAAE,qBAAqB,EAAE;AAAI,CAAE;AAEhE;;;;;;;AAOA,OAAO,MAAMC,OAAO,GAAGA,CACnBC,SAAiC,EACjCC,UAA6B;AAC7B;AACAC,wBAAiC,KAEjCnB,KAAK,CAACoB,UAAU,CAAC,CAACC,KAAQ,EAAEC,GAAG,KAAI;EAC/B,MAAM;IAAEC,KAAK;IAAEC;EAAK,CAAE,GAAGxB,KAAK,CAACyB,UAAU,CAAqCxB,iBAAiB,CAAC,IAAI,EAAE;EAEtG,IAAI,CAACE,SAAS,EAAE,EAAE;IACd,MAAMuB,eAAe,GAAGC,KAAK,CAACC,OAAO,CAACV,UAAU,CAAC,GAAGA,UAAU,CAACW,IAAI,CAAC,IAAI,CAAC,GAAGX,UAAU;IACtF,OACIlB,KAAA,CAAA8B,aAAA,CAAA9B,KAAA,CAAA+B,QAAA,QACI/B,KAAA,CAAA8B,aAAA;MAAA,GACQf,iBAAiB;MAAA,yBACEI,wBAAwB;MAC/Ca,uBAAuB,EAAE;QAAEC,MAAM,EAAEP;MAAe;IAAE,EACtD,EACF1B,KAAA,CAAA8B,aAAA,CAACb,SAAS;MAAA,GAAKI,KAAK;MAAEC,GAAG,EAAEA;IAAG,EAAI,CACnC;;EAIX;EACAtB,KAAK,CAACkC,kBAAkB,CAAC,MAAK;IAC1B;IACA;IACA,IAAIf,wBAAwB,IAAIV,kCAAkC,CAAC0B,GAAG,CAAChB,wBAAwB,CAAC,EAAE;IAElG,MAAMiB,GAAG,GAAGT,KAAK,CAACC,OAAO,CAACV,UAAU,CAAC,GAAGA,UAAU,GAAGA,UAAU,CAACJ,KAAK,CAAC,IAAI,CAAC;IAC3EsB,GAAG,CAACC,OAAO,CAACC,IAAI,IAAIA,IAAI,IAAIpC,GAAG,CAACqC,aAAa,CAACD,IAAI,EAAEf,KAAK,EAAEC,KAAK,CAAC,CAAC;EACtE,CAAC,EAAE,EAAE,CAAC;EAEN,OAAOxB,KAAA,CAAA8B,aAAA,CAACb,SAAS;IAAA,GAAKI,KAAK;IAAEC,GAAG,EAAEA;EAAG,EAAI;AAC7C,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}