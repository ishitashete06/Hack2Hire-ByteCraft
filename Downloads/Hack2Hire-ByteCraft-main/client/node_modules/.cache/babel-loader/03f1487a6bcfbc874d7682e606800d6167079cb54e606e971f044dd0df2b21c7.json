{"ast":null,"code":"import React from \"react\";\nimport { useConstant } from \"../components/utils/useConstant.js\";\nimport { assert } from \"../utils/assert.js\";\nimport { cx } from \"./cx.js\";\nimport { useAddVariantProps } from \"./useAddVariantProps.js\";\nimport { useForceUpdate } from \"./useForceUpdate.js\";\nfunction createGestureVariant(variant, type) {\n  return `${variant}-${type}`;\n}\nfunction nextVariant(allVariants, currentVariant) {\n  const index = allVariants.indexOf(currentVariant);\n  let nextIndex = index + 1;\n  if (nextIndex >= allVariants.length) {\n    nextIndex = 0;\n  }\n  // We ensure the index could not go out of bound with the code above, the\n  // assert here is just to appease Typescript.\n  const nextVariant = allVariants[nextIndex];\n  assert(nextVariant !== undefined, \"nextVariant should be defined\");\n  return nextVariant;\n}\nfunction activeTransition(transitions, variant) {\n  if (!transitions) return undefined;\n  if (variant) {\n    const variantTransition = transitions[variant];\n    if (variantTransition) return variantTransition;\n  }\n  return transitions.default;\n}\nfunction getGesture(enabledGestures, isHovered, isPressed) {\n  const {\n    hover,\n    pressed\n  } = enabledGestures || {};\n  if (pressed && isPressed) return \"pressed\";\n  if (hover && isHovered) return \"hover\";\n}\nfunction createVariantClassName(baseVariant, variantClassNames) {\n  const mappedClassName = variantClassNames[baseVariant];\n  if (mappedClassName) return mappedClassName;\n  return `framer-${\"v\" /* VariantSelector.Variant */}-${baseVariant}`;\n}\nfunction safeBaseVariant(targetVariant, fallbackVariant, validBaseVariants) {\n  if (!targetVariant) return fallbackVariant;\n  if (validBaseVariants.has(targetVariant)) return targetVariant;\n  return fallbackVariant;\n}\n/**\n * Flag setVariantState as cycling variants.\n * @public\n */\nexport const CycleVariantState = /* @__PURE__ */Symbol(\"cycle\");\n/**\n * Handle stateful logic in Framer Canvas Components.\n *\n * @public\n */\nexport function useVariantState({\n  variant,\n  defaultVariant: externalDefaultVariant,\n  transitions: externalTransitions,\n  enabledGestures: externalEnabledGestures,\n  cycleOrder: externalCycleOrder = [],\n  variantProps = {},\n  variantClassNames = {}\n}) {\n  const forceUpdate = useForceUpdate();\n  const validBaseVariants = useConstant(() => new Set(externalCycleOrder));\n  const internalState = React.useRef({\n    isHovered: false,\n    isPressed: false,\n    baseVariant: safeBaseVariant(variant, externalDefaultVariant, validBaseVariants),\n    lastVariant: variant,\n    gestureVariant: undefined,\n    // When used in generated components, these are static values defined\n    // outside of the component function that also need to not result in\n    // memoized values being recalculated, so we dump them into the ref.\n    defaultVariant: externalDefaultVariant,\n    enabledGestures: externalEnabledGestures,\n    cycleOrder: externalCycleOrder,\n    transitions: externalTransitions\n  });\n  const resolveNextVariant = React.useCallback(targetBaseVariant => {\n    const {\n      isHovered,\n      isPressed,\n      enabledGestures,\n      defaultVariant\n    } = internalState.current;\n    const nextBaseVariant = safeBaseVariant(targetBaseVariant, defaultVariant, validBaseVariants);\n    const gesture = getGesture(enabledGestures?.[nextBaseVariant], isHovered, isPressed);\n    const nextGestureVariant = gesture ? createGestureVariant(nextBaseVariant, gesture) : undefined;\n    return [nextBaseVariant, nextGestureVariant];\n  }, [validBaseVariants]);\n  const setGestureState = React.useCallback(({\n    isHovered,\n    isPressed\n  }) => {\n    if (isHovered !== undefined) internalState.current.isHovered = isHovered;\n    if (isPressed !== undefined) internalState.current.isPressed = isPressed;\n    const {\n      baseVariant,\n      gestureVariant,\n      defaultVariant\n    } = internalState.current;\n    const [nextBase, nextGesture] = resolveNextVariant(baseVariant);\n    // Only force a render if the new active variants have changed.\n    if (nextBase !== baseVariant || nextGesture !== gestureVariant) {\n      internalState.current.baseVariant = nextBase || defaultVariant;\n      internalState.current.gestureVariant = nextGesture;\n      forceUpdate();\n    }\n  }, [resolveNextVariant, forceUpdate]);\n  const setVariant = React.useCallback(proposedVariant => {\n    const {\n      defaultVariant,\n      cycleOrder,\n      baseVariant,\n      gestureVariant\n    } = internalState.current;\n    const nextBaseVariant = proposedVariant === CycleVariantState ? nextVariant(cycleOrder || [], baseVariant || defaultVariant) : proposedVariant;\n    const [nextBase, nextGesture] = resolveNextVariant(nextBaseVariant);\n    // Only force a render if the new active variants have changed.\n    if (nextBase !== baseVariant || nextGesture !== gestureVariant) {\n      internalState.current.baseVariant = nextBase || defaultVariant;\n      internalState.current.gestureVariant = nextGesture;\n      forceUpdate();\n    }\n  }, [resolveNextVariant, forceUpdate]);\n  if (variant !== internalState.current.lastVariant) {\n    const [nextBase, nextGesture] = resolveNextVariant(variant);\n    internalState.current.lastVariant = nextBase;\n    if (nextBase !== internalState.current.baseVariant || nextGesture !== internalState.current.gestureVariant) {\n      internalState.current.baseVariant = nextBase;\n      internalState.current.gestureVariant = nextGesture;\n    }\n  }\n  const {\n    baseVariant,\n    gestureVariant,\n    defaultVariant,\n    enabledGestures,\n    isHovered,\n    isPressed\n  } = internalState.current;\n  // Backwards compatibility for old components generated before\n  // addVariantProps was extracted to it's own hook.\n  const addVariantProps = useAddVariantProps(internalState.current.baseVariant, internalState.current.gestureVariant, variantProps);\n  return React.useMemo(() => {\n    const variants = [];\n    if (baseVariant !== defaultVariant) variants.push(baseVariant);\n    if (gestureVariant) variants.push(gestureVariant);\n    return {\n      variants,\n      baseVariant,\n      gestureVariant,\n      transition: activeTransition(internalState.current.transitions, baseVariant),\n      setVariant,\n      setGestureState,\n      addVariantProps,\n      classNames: cx(createVariantClassName(baseVariant, variantClassNames), getGesture(enabledGestures?.[baseVariant], isHovered, isPressed))\n    };\n  }, [baseVariant, gestureVariant, isHovered, isPressed, addVariantProps, setVariant, defaultVariant, enabledGestures, setGestureState, variantClassNames]);\n}","map":{"version":3,"names":["React","useConstant","assert","cx","useAddVariantProps","useForceUpdate","createGestureVariant","variant","type","nextVariant","allVariants","currentVariant","index","indexOf","nextIndex","length","undefined","activeTransition","transitions","variantTransition","default","getGesture","enabledGestures","isHovered","isPressed","hover","pressed","createVariantClassName","baseVariant","variantClassNames","mappedClassName","safeBaseVariant","targetVariant","fallbackVariant","validBaseVariants","has","CycleVariantState","Symbol","useVariantState","defaultVariant","externalDefaultVariant","externalTransitions","externalEnabledGestures","cycleOrder","externalCycleOrder","variantProps","forceUpdate","Set","internalState","useRef","lastVariant","gestureVariant","resolveNextVariant","useCallback","targetBaseVariant","current","nextBaseVariant","gesture","nextGestureVariant","setGestureState","nextBase","nextGesture","setVariant","proposedVariant","addVariantProps","useMemo","variants","push","transition","classNames"],"sources":["../../src/modules/useVariantState.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}