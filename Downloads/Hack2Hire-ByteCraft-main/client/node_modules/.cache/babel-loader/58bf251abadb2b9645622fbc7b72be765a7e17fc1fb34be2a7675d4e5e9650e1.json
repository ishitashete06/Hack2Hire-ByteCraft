{"ast":null,"code":"import { ControlType } from \"../render/types/PropertyControls.js\";\nimport { isArray, isBoolean, isFunction, isNumber, isObject, isString, isUndefined } from \"./utils.js\";\nfunction isReactComponent(component) {\n  // Before we were using `instanceof React.Component` instead of `isObject` but unfortunately\n  // that check isn't compatible with `React.forwardRef`.\n  return isObject(component) || isFunction(component);\n}\nconst optionalKey = \"optional\";\nfunction controlIsOptional(control) {\n  return !!control && optionalKey in control && control[optionalKey] === true;\n}\nfunction shouldBeNever(_) {}\nfunction getControlDefaultValue(control) {\n  try {\n    switch (control.type) {\n      case ControlType.String:\n      case ControlType.Color:\n      case ControlType.Date:\n      case ControlType.Link:\n        return isString(control.defaultValue) ? control.defaultValue : undefined;\n      case ControlType.Boolean:\n        return isBoolean(control.defaultValue) ? control.defaultValue : undefined;\n      case ControlType.Enum:\n        if (isUndefined(control.defaultValue)) return undefined;\n        return control.options.includes(control.defaultValue) ? control.defaultValue : undefined;\n      case ControlType.FusedNumber:\n      case ControlType.Number:\n        return isNumber(control.defaultValue) ? control.defaultValue : undefined;\n      case ControlType.Transition:\n        return isObject(control.defaultValue) ? control.defaultValue : undefined;\n      case ControlType.Font:\n        return isObject(control.defaultValue) ? control.defaultValue : undefined;\n      case ControlType.Object:\n        {\n          const value = isObject(control.defaultValue) ? control.defaultValue : {};\n          if (isObject(control.controls)) {\n            applyControlDefaultsToDefaultProps(value, control.controls);\n          }\n          return value;\n        }\n      case ControlType.Array:\n        return isArray(control.defaultValue) ? control.defaultValue : undefined;\n      case ControlType.File:\n      case ControlType.Image:\n      case ControlType.RichText:\n      case ControlType.PageScope:\n      case ControlType.EventHandler:\n      case ControlType.SegmentedEnum:\n      case ControlType.ResponsiveImage:\n      case ControlType.ComponentInstance:\n        return undefined;\n      // No default\n      default:\n        // We are not asserting because we never want this to crash. It's run while a user is coding.\n        shouldBeNever(control);\n        return undefined;\n    }\n  } catch {\n    return undefined;\n  }\n}\nfunction applyControlDefaultsToDefaultProps(defaultProps, controls) {\n  for (const controlKey in controls) {\n    const control = controls[controlKey];\n    if (!control) continue;\n    // Ignore if a value is already set\n    const currentDefault = defaultProps[controlKey];\n    if (!isUndefined(currentDefault)) continue;\n    // Ignore if the value needs to support undefined\n    if (controlIsOptional(control)) continue;\n    // Get default value from control\n    const defaultValue = getControlDefaultValue(control);\n    if (isUndefined(defaultValue)) continue;\n    defaultProps[controlKey] = defaultValue;\n  }\n}\nfunction getDefaultProps(component) {\n  if (isObject(component.defaultProps)) {\n    return component.defaultProps;\n  }\n  const defaultProps = {};\n  component.defaultProps = defaultProps;\n  return defaultProps;\n}\nexport function applyControlDefaultsToReactDefaultProps(component, controls) {\n  if (!isReactComponent(component)) return;\n  const defaultProps = getDefaultProps(component);\n  applyControlDefaultsToDefaultProps(defaultProps, controls);\n}","map":{"version":3,"names":["ControlType","isArray","isBoolean","isFunction","isNumber","isObject","isString","isUndefined","isReactComponent","component","optionalKey","controlIsOptional","control","shouldBeNever","_","getControlDefaultValue","type","String","Color","Date","Link","defaultValue","undefined","Boolean","Enum","options","includes","FusedNumber","Number","Transition","Font","Object","value","controls","applyControlDefaultsToDefaultProps","Array","File","Image","RichText","PageScope","EventHandler","SegmentedEnum","ResponsiveImage","ComponentInstance","defaultProps","controlKey","currentDefault","getDefaultProps","applyControlDefaultsToReactDefaultProps"],"sources":["../../src/utils/applyControlDefaultsToReactDefaultProps.ts"],"sourcesContent":[null],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}